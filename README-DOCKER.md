# üê≥ Docker —É—Å—Ç–∞–Ω–æ–≤–∫–∞

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å Docker, Nginx –∏ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Docker
- Docker Compose
- –î–æ–º–µ–Ω —Å A-–∑–∞–ø–∏—Å—å—é –Ω–∞ –≤–∞—à —Å–µ—Ä–≤–µ—Ä

## –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone git@github.com:Maybeoff/donat.git
cd donat

# –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ docker-setup –±—Ä–∞–Ω—á
git checkout docker-setup

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É
chmod +x setup.sh
./setup.sh
```

–°–∫—Ä–∏–ø—Ç —Å–ø—Ä–æ—Å–∏—Ç:
- –î–æ–º–µ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, donat.example.com)
- Email –¥–ª—è Let's Encrypt
- YOOMONEY_CLIENT_ID
- YOOMONEY_CLIENT_SECRET  
- YOOMONEY_RECEIVER (–Ω–æ–º–µ—Ä —Å—á–µ—Ç–∞)

## –ß—Ç–æ –¥–µ–ª–∞–µ—Ç setup.sh

1. ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ Docker
2. üìù –°–æ–∑–¥–∞–µ—Ç .env —Ñ–∞–π–ª —Å –≤–∞—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏
3. üìÅ –°–æ–∑–¥–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
4. üîê –ü–æ–ª—É—á–∞–µ—Ç SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ—Ç Let's Encrypt
5. üöÄ –ó–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (Node.js + Nginx)
6. üîÑ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
docker-compose restart

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down

# –ó–∞–ø—É—Å–∫
docker-compose up -d

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞
git pull
docker-compose build
docker-compose up -d
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
donat/
‚îú‚îÄ‚îÄ Dockerfile              # –û–±—Ä–∞–∑ Node.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ docker-compose.yml      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
‚îú‚îÄ‚îÄ nginx.conf.template     # –®–∞–±–ª–æ–Ω nginx
‚îú‚îÄ‚îÄ setup.sh               # –°–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏
‚îú‚îÄ‚îÄ certbot/               # SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ conf/
‚îÇ   ‚îî‚îÄ‚îÄ www/
‚îî‚îÄ‚îÄ data/                  # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
```

## –ü–æ—Ä—Ç—ã

- 80 - HTTP (—Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ HTTPS)
- 443 - HTTPS
- 3000 - Node.js (–≤–Ω—É—Ç—Ä–∏ Docker —Å–µ—Ç–∏)

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ SSL

–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥—ã–µ 12 —á–∞—Å–æ–≤ —á–µ—Ä–µ–∑ certbot –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä.

## Troubleshooting

### –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ:
- –î–æ–º–µ–Ω —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –≤–∞—à —Å–µ—Ä–≤–µ—Ä (A-–∑–∞–ø–∏—Å—å)
- –ü–æ—Ä—Ç—ã 80 –∏ 443 –æ—Ç–∫—Ä—ã—Ç—ã
- –ù–µ—Ç –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –Ω–∞ —ç—Ç–∏—Ö –ø–æ—Ä—Ç–∞—Ö

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

–ë–∞–∑–∞ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `./donat.db` –∏ –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä.

### –õ–æ–≥–∏

```bash
# –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
docker-compose logs app

# –õ–æ–≥–∏ nginx
docker-compose logs nginx

# –õ–æ–≥–∏ certbot
docker-compose logs certbot
```
